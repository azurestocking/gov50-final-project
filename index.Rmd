---
title: "TITLE"
author: "AUTHOR"
description: "DESCRIPTION"
output:
  distill::distill_article:
    self_contained: false
---

```{r}
options(width = 100)
library(infer)
library(tidyverse)
library(ggplot2)
```



## Introduction
* where you introduce the research question
* hypothesis
* briefly describe why it is interesting



## Data
This dataset is based on the system data of a bike sharing company, Capital Bikeshare and weather information from http://www.freemeteo.com, showing the daily count of rental bikes between years 2011 and 2012 in the system with the corresponding weather conditions.

The following table shows the variables excerpted from the raw dataset. It has 6 independent variables, including `workingday`, `weathersit`, `temp`, `atemp`, `hum`, and `windspeed` and 1 dependent variable, `cnt`. Precisely, the `cnt` is a discrete variable of the total number of bikes borrowed by both casual and registered users. The `workingday` is a dichotomous variable; if the day is neither weekend nor holiday is 1, otherwise is 0. The `weathersit` is a categorical variable coded from 1 to 4 in accordance with the weather inclemency. The `temp` is the normalized temperature in Celsius; the values are derived via $\frac{t - t_{min}}{t_{max} - t_{min}}$, where $t_{min} = -8$, $t_{max} = +39$ in hourly scale. The `atemp` is the normalized feeling temperature in Celsius; the values are derived via $\frac{t - t_{min}}{t_{max} - t_{min}}$, where $t_{min} = -16$, $t_{max} = +50$ in hourly scale. The `hum` is the normalized humidity where the values are divided to 100. The `windspeed` is the normalized wind speed where the values are divided to 67.

This is a cross-sectional study that runs a bivariate regression of `cnt` on `weathersit` to explores the relationship between the count of rental bikes and weather inclemency and then a multivariate regression of `cnt` on all independent variables to control the confounders.

| Variable     | Description                                                                                                                        |
|---------------------|---------------------------------------------------|
| `workingday` | Indicator variable for whether day is a working day (1) or not (0). |
| `weathersit` | Indicator variable for weather inclemency, segmented as sunny or cloudy (1), mist (2), light precipitation (3), and heavy precipitation (4). |
| `temp`       | Normalized temperature in Celsius.                                                                                                 |
| `atemp`      | Normalized feeling temperature in Celsius.                                                                                         |
| `hum`        | Normalized humidity.                                                                                                               |
| `windspeed`  | Normalized wind speed.                                                                                                             |
| `cnt`        | Count of total rental bikes.                                                                  |

According to the plot (Figure 1), the distribution of the dependent variable, the daily count of rental bikes, looks approximately multimodal with one primary peak at the center of the curve around 4500 and two smaller peaks around 2000 and 7000, respectively.

```{r}
df_raw <- read.csv("day.csv")
df <- df_raw[, c(8, 9, 10, 11, 12, 13, 16)]

dist_cnt <- df |>
  ggplot(aes(x = cnt)) +
  geom_histogram() +
  labs(title = "Figure 1: Distribution of CNT",
       x = "Count of CNT",
       y = "Count")
dist_cnt
```



## Result
* figure 2: one bivariate regression
* one multivariate regression (control confounders)
* separate plots of the main relationship of interest (figure 3, 4, 5)
* a summary and discussion of results in substantive context
* interpret (in plain English) the main coefficient of interest in your regression, comment on the statistical significance of the estimated coefficient, and say whether or not you believe the coefficient to represent a causal effect

```{r}
reg_main <- lm (cnt ~ weathersit, data = df)
summary(reg_main)

df |>
  ggplot(aes(x = weathersit, y = cnt)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Figure 2: Regression of CNT on Weather Inclemency",
       x = "Weather Inclemency",
       y = "CNT")
```

```{r}
reg_all <- lm(cnt ~ workingday + weathersit + temp + atemp + hum + windspeed, data = df)
summary(reg_all)
```

```{r}
df |>
  ggplot(aes(x = atemp, y = cnt)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Figure 3: Regression of CNT on Feeling Temperature",
       x = "Normalized feeling temperature (Celsius)",
       y = "CNT")

df |>
  ggplot(aes(x = hum, y = cnt)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Figure 4: Regression of CNT on Humidity",
       x = "Normalized Humidity",
       y = "CNT")

df |>
  ggplot(aes(x = windspeed, y = cnt)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Figure 5: Regression of CNT on Wind Speed",
       x = "Normalized Wind Speed",
       y = "CNT")
```



## Conclusion
* a recap of results
* discussion of limitations of the study
* how to improve the study in the future (a paragraph)
