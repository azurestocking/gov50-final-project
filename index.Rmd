---
title: "More Weather Inclemency, Less Shared Bike?"
author: "Jinming Li"
description: "Final Project for 2022 Fall GOV50 in Harvard College"
output:
  distill::distill_article:
    self_contained: false
---

```{r}
options(width = 100)
library(infer)
library(tidyverse)
library(ggplot2)
library(dplyr)
```




```{r}
df_raw <- read.csv("day.csv")
df <- df_raw[, c(8, 9, 10, 11, 12, 13, 16)]

dist_cnt <- df |>
  ggplot(aes(x = cnt)) +
  geom_histogram() +
  labs(title = "Figure 1: Distribution of CNT",
       x = "Count of CNT",
       y = "Count")
dist_cnt
```


In the bivariate regression, the coefficient of `weathersit` is -1057.3, which means that a one-point increase in weather inclemency is associated with a decrease in count of total rental bikes of 1057.3 on average. According to the boxplot (Figure 2), as the lower quartile, median, and upper quartile get lower when the weather gets more inclement, the count of total rental bikes tends to decrease when the weather inclemency increases.

```{r}
reg_main <- lm (cnt ~ weathersit, data = df)
summary(reg_main)

df |>
  mutate(
    weather = case_when(
      weathersit == 1 ~ "Sunny or Cloudy",
      weathersit == 2 ~ "Mist",
      weathersit == 3 ~ "Light Precipitation",
      weathersit == 4 ~ "Heavy Precipitation"
    )
  ) |>
  ggplot(aes(x = weather, y = cnt)) +
  geom_boxplot() +
  labs(title = "Figure 2: Relationship Between CNT and Weather",
       x = "Weather",
       y = "CNT")
```
