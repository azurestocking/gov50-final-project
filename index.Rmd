---
title: "TITLE"
author: "AUTHOR"
description: "DESCRIPTION"
output:
  distill::distill_article:
    self_contained: false
---

```{r}
options(width = 100)
library(infer)
library(tidyverse)
library(ggplot2)
library(dplyr)
```



## Introduction
* where you introduce the research question
* hypothesis
* briefly describe why it is interesting

is a shared transport service where bicycles are available for shared use by individuals at low cost.
by 2022, approximately 3,000 cities worldwide offer bike-sharing systems

Bike sharing systems are new generation of traditional bike rentals where whole process from membership, rental and return back has become automatic. Through these systems, user is able to easily rent a bike from a particular position and return back at another position. Currently, there are about over 500 bike-sharing programs around the world which is composed of over 500 thousands bicycles. Today, there exists great interest in these systems due to their important role in traffic, environmental and health issues.

Apart from interesting real world applications of bike sharing systems, the characteristics of data being generated by these systems make them attractive for the research. Opposed to other transport services such as bus or subway, the duration of travel, departure and arrival position is explicitly recorded in these systems. This feature turns bike sharing system into a virtual sensor network that can be used for sensing mobility in the city. Hence, it is expected that most of important events in the city could be detected via monitoring these data.


Does unified government enhance legislative productivity? In this study, I plan to examine the extent to which periods of unified government produce more landmark laws. I hypothesize that legislative productivity increases during periods of unified government in which one party controls both Houses of Congress and the presidency relative to periods of divided government. During periods of unified government, I expect that it is more likely for major bills to pass both Houses and gain the president’s signature. During periods of divided government, it is more difficult to reach a consensus around legislation that can pass each House and gain the president’s approval. My sample is comprised of each of the 79th (1945-1946) through 103rd (1993-1994) Congresses. My unit of analysis is a Congress (e.g., the 88th Congress). The explanatory variable of interest is whether there is unified government (both Houses and the presidency are controlled by the same party) or divided government. The variable is coded =1 for unified government and =0 for divided government. My outcome variable is the count of landmark pieces of legislation passed in a given Congress. For instance, if the variable were coded =11, it would mean that 11 pieces of landmark legislation were signed into law in that Congress. This variable is measured from David Mayhew’s data set on landmark legislation and relies on Mayhew’s expert knowledge to classify legislation as “landmark.” If I observe greater landmark legislative productivity under unified government relative to divided government, this would provide support for my hypothesis. If, on the other hand, I observe less productivity or the same level of productivity under unified government, this would provide evidence against my hypothesis. When I run my regression of the count of landmark legislation on the unified government indicator variable, a positive, significant coefficient would indicate support for my hypothesis.



## Data
This dataset is based on the system data of a bike sharing company, Washington, D.C.'s Capital Bikeshare and weather information from http://www.freemeteo.com, showing the daily count of rental bikes between years 2011 and 2012 in the system with the corresponding weather conditions.

The following table shows the variables excerpted from the raw dataset. It has 6 independent variables, including `workingday`, `weathersit`, `temp`, `atemp`, `hum`, and `windspeed` and 1 dependent variable, `cnt`. Precisely, the `cnt` is a discrete variable of the total number of bikes borrowed by both casual and registered users. The `workingday` is a dichotomous variable; if the day is neither weekend nor holiday is 1, otherwise is 0. The `weathersit` is a categorical variable coded from 1 to 4 in accordance with the weather inclemency. The `temp` is the normalized temperature in Celsius whose values are derived via $\frac{t - t_{min}}{t_{max} - t_{min}}$. The `atemp` is the normalized feeling temperature in Celsius whose values are derived via $\frac{t - t_{min}}{t_{max} - t_{min}}$. The `hum` is the normalized humidity where the values are divided to 100. The `windspeed` is the normalized wind speed where the values are divided to 67.

This is a cross-sectional study that runs a bivariate regression of `cnt` on `weathersit` to explores the relationship between the count of rental bikes and weather inclemency and then a multivariate regression of `cnt` on all independent variables to control the confounders.

| Variable     | Description                                                                                                                        |
|---------------------|---------------------------------------------------|
| `workingday` | Indicator variable for whether day is a working day (1) or not (0). |
| `weathersit` | Indicator variable for weather inclemency, segmented as sunny or cloudy (1), mist (2), light precipitation (3), and heavy precipitation (4). |
| `temp`       | Normalized temperature in Celsius.                                                                                                 |
| `atemp`      | Normalized feeling temperature in Celsius.                                                                                         |
| `hum`        | Normalized humidity.                                                                                                               |
| `windspeed`  | Normalized wind speed.                                                                                                             |
| `cnt`        | Count of total rental bikes.                                                                  |

According to the plot (Figure 1), the distribution of the dependent variable, the daily count of rental bikes, looks approximately multimodal with one primary peak at the center of the curve around 4500 and two smaller peaks around 2000 and 7000, respectively.

```{r}
df_raw <- read.csv("day.csv")
df <- df_raw[, c(8, 9, 10, 11, 12, 13, 16)]

dist_cnt <- df |>
  ggplot(aes(x = cnt)) +
  geom_histogram() +
  labs(title = "Figure 1: Distribution of CNT",
       x = "Count of CNT",
       y = "Count")
dist_cnt
```



## Result
**whether or not you believe the coefficient to represent a causal effect**

In the bivariate regression, the coefficient of `weathersit` is -1057.3, which means that a one-point increase in weather inclemency is associated with a decrease in count of total rental bikes of 1057.3 on average. According to the boxplot (Figure 2), as the lower quartile, median, and upper quartile get lower when the weather gets more inclement, the count of total rental bikes tends to decrease when the weather inclemency increases.

```{r}
reg_main <- lm (cnt ~ weathersit, data = df)
summary(reg_main)

df |>
  mutate(
    weather = case_when(
      weathersit == 1 ~ "Sunny or Cloudy",
      weathersit == 2 ~ "Mist",
      weathersit == 3 ~ "Light Precipitation",
      weathersit == 4 ~ "Heavy Precipitation"
    )
  ) |>
  ggplot(aes(x = weather, y = cnt)) +
  geom_boxplot() +
  labs(title = "Figure 2: Relationship between CNT and Weather",
       x = "Weather",
       y = "CNT")
```

In the multivariate regression, the p-values of `weathersit`, `atemp`, `hum`, and `windspeed` are smaller than 0.1, so their coefficient are statistically significant at the 0.1 level.

Precisely, the coefficient of `weathersit` is -483.3, meaning that holding other variables at a fixed value, a one-point increase in weather inclemency is associated with a decrease in count of total rental bikes of 483.3 on average. The coefficient of `atemp` is 4483.3, meaning that holding other variables at a fixed value, a one-point increase in normalized feeling temperature is associated with an increase in count of total rental bikes of 4483.3 on average. The coefficient of `hum` is -1936.8, meaning that holding other variables at a fixed value, a one-point increase in normalized humidity is associated with a decrease in count of total rental bikes of 1936.8 on average. The coefficient of `windspeed` is -3963.3, meaning that holding other variables at a fixed value, a one-point increase in normalized wind speed is associated with a decrease in count of total rental bikes of 3963.3 on average.

Also, there is an increase in the coefficient of `weathersit` in the two models...

```{r}
reg_all <- lm(cnt ~ workingday + weathersit + temp + atemp + hum + windspeed, data = df)
summary(reg_all)
```

```{r}
df |>
  ggplot(aes(x = atemp, y = cnt)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Figure 3: Regression of CNT on Feeling Temperature",
       x = "Normalized feeling temperature",
       y = "CNT")

df |>
  ggplot(aes(x = hum, y = cnt)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Figure 4: Regression of CNT on Humidity",
       x = "Normalized Humidity",
       y = "CNT")

df |>
  ggplot(aes(x = windspeed, y = cnt)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Figure 5: Regression of CNT on Wind Speed",
       x = "Normalized Wind Speed",
       y = "CNT")
```



## Conclusion
* a recap of results
* discussion of limitations of the study
* how to improve the study in the future (a paragraph)
